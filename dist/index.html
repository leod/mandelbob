<!doctype html>
<html>
  <head>
    <title>Mandelbob</title>
  </head>
  <body>
    <div id="view" style="width:800px;height:640px"></div>

    <script id="vertexShader" type="x-shader/x-vertex">
        uniform float time;
        uniform vec2 resolution;
        void main()	{
            gl_Position = vec4(position, 1.0);
        }
    </script>
    
    <script id="fragmentShader" type="x-shader/x-fragment">
        uniform float time;
        uniform vec2 resolution;
        uniform vec2 center;
        uniform float zoom;

        const vec2 viewSize = vec2(3.0, 3.0);
        const vec2 viewMin = vec2(-2.0, -1.5);

        const int max_iteration = 1000;

        int mandelbrot(vec2 c) {
            vec2 z = vec2(0.0, 0.0);

            for (int iteration = 0; iteration < max_iteration; iteration++) {
                if (dot(z, z) > 4.0)
                    return iteration;
                z = vec2(z.x*z.x - z.y*z.y, 2.0*z.x*z.y) + c;
            }

            return max_iteration;
        }

        void main()	{
            vec2 centeredScreenCord = 2.0 * gl_FragCoord.xy / resolution - 1.0;
            vec2 c = center + centeredScreenCord / zoom * 1.5 * vec2(1.0, resolution.y / resolution.x) - vec2(0.5, 0.0);

            int iteration = mandelbrot(c);

            vec4 c1 = vec4(0.0, 0.0, 0.0, 1.0);
            vec4 c2 = vec4(1.0, 1.0, 1.0, 1.0);
            float t = float(iteration) / float(max_iteration);

            gl_FragColor = c1 * (1.0 - t) + c2 * t;
        }
    </script>

    <script src="main.js"></script>
  </body>
</html>
